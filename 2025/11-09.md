# 2025-11-09
## 今日学んだこと（基本情報技術者）

---

# 1) データベースとは？
- 大量のデータを**効率よく保存・検索・更新**する仕組み  
- 必要な人が必要な形式で、正確にデータを扱うためのシステム

### データベースが必要な理由
- データの整合性を保つ  
- 複数ユーザーが同時に利用できる  
- データの重複を減らし、管理しやすくなる  
- 障害時でもデータを守る仕組みがある  
- 高速な検索と更新が可能

---

# 2) DBMS（データベース管理システム）
- データベースを作り、操作し、管理するためのソフトウェア  
例：MySQL、PostgreSQL、Oracle、SQLite など

### DBMSが行う主な役割
- データの保存/検索/更新  
- 排他制御  
- トランザクション管理  
- 障害回復（バックアップ、ジャーナル）  
- 正規化による整合性維持

---

# 3) スキーマ（データベースの3層構造）
DBを3つの観点でモデル化したもの：

| 層 | 内容 |
|---|---|
| **外部スキーマ（利用者ビュー）** | ユーザーごとの見え方 |
| **概念スキーマ（論理構造）** | データベース全体の構造 |
| **内部スキーマ（物理構造）** | 実際の保存方法（ファイル・インデックス等） |

---

# 4) ACID特性（トランザクションの4要素）
トランザクションを安全に行うための特性：

| 特性 | 内容 |
|------|------|
| **A：Atomicity（原子性）** | すべて実行 or まったく実行しない |
| **C：Consistency（一貫性）** | ルール（制約）を常に満たす |
| **I：Isolation（隔離性）** | 同時実行しても互いに影響しない |
| **D：Durability（耐久性）** | コミットしたデータは失われない |

---

# 5) データベースの仕組み（RDBの構造）
### ● RDB（リレーショナルデータベース）
- 行と列で構成された **表（テーブル）** でデータを管理  
- 主な用語：  
  - **テーブル**：表  
  - **レコード**：行  
  - **フィールド**：列（属性）  
  - **キー（主キー、外部キー）**

### 主キーの種類
- **単一キー**：1つの列で一意に識別  
- **複合キー**：複数の列の組み合わせで一意にする  

---

# 6) 正規化
データの重複や矛盾をなくすための設計手法。

### 関数従属
- **A → B**：Aが決まればBが決まる関係

### 部分関数従属
- 複合キーの一部にだけ依存すること  
- 部分関数従属を取り除くと第2正規形になる

---

# 7) 排他制御（同時処理を安全にする仕組み）
複数ユーザーが同時に更新すると矛盾が起きるため、**ロック**で制御する。

### ロックの種類
| 種類 | 内容 |
|------|------|
| **共有ロック（Sロック）** | 読み取り専用。複数で共有可能。 |
| **専有ロック（Xロック）** | 書き込み用。1つだけ取得可能。 |

### ロック粒度
- **テーブルロック**：テーブル全体をロック  
- **レコードロック**：1行だけロック  
- 粒度が細いほど並行性は高いが管理が複雑

### デッドロック
- 複数トランザクションが互いを待ち続けて停止する状況  
- DBMSが検出して片方を中止する

---

# 8) トランザクション処理とは？
- 複数の処理を **1つのまとまり** として扱う仕組み  
- 途中で失敗したらすべて元に戻す（原子性）

---

# 9) 障害管理（障害が起きた時どう回復するか）
DBMSがデータを守るために提供する機能：

| 用語 | 内容 |
|------|------|
| **コミット** | トランザクションの確定 |
| **ロールバック** | 異常時に変更前に戻す |
| **ログ（ジャーナルファイル）** | 更新履歴の記録 |
| **ロールフォワード** | バックアップ＋ログから最新状態に復元 |
| **ウォームスタート** | 障害時にログを用いて素早く再起動 |
| **コールドスタート** | システム全体を初期化して再起動 |
| **レプリケーション** | 他サーバへコピーして故障に備える |

---

# 10) 2相コミット（分散トランザクションの整合性）
複数のDBにまたがるトランザクションを安全に行うプロトコル。

1. **準備フェーズ（投票フェーズ）**  
   - 各ノードが「コミット可能か？」を返す  
2. **コミットフェーズ**  
   - 全員OK → 全ノードがコミット  
   - NGが1つでも → 全ノードがロールバック

---

## 今日のまとめ
- DBは大量データを正確に扱うための基盤  
- ACID特性は安全なトランザクションの基本  
- RDBはテーブル・レコード・フィールドで構成  
- 正規化でデータの重複や矛盾をなくす  
- ロックによる排他制御とデッドロック回避が重要  
- 障害時はロールバック・ロールフォワードで復旧  
- 分散環境では2相コミットで整合性を維持  

---

## 次の学習候補
- SQL（SELECT / JOIN / GROUP BY）  
- インデックス設計  
- トランザクション分離レベル（READ COMMITTED など）  

